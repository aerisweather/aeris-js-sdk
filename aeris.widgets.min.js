(function(){var b=this;var c=b.jQuery;var a=b.Aeris;if(!a){throw"AerisException"}a.provide("Aeris.widgets");a.widgets.Currents=a.Widget.extend({prefix:"currents",defaults:{cls:"",tpl:'<div class="aeris-widget-outer aeris-widget-currents"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{places.0.place.name}}, {{places.0.place.state}}</div><div class="aeris-widget-loader-update"></div><div class="aeris-widget-tbar"><div class="aeris-widget-tbar-ctrls"><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-search"></a><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-geolocate"></a></div></div></div>{{> search}}{{#advisories}}<div class="aeris-widget-currents-advblock"><span class="aeris-widget-currents-adv">{{details.name}}</span></div>{{/advisories}}<div class="aeris-widget-bottom"><div class="aeris-widget-currents-wxblock"><div class="aeris-widget-currents-icon{{#observations.0.ob.isDay}} aeris-widget-currents-icon-day{{/observations.0.ob.isDay}}"><img src="{{paths.wxicons}}{{observations.0.ob.icon}}" /></div><div class="aeris-widget-currents-temp">{{observations.0.ob.tempF}}&deg;<span class="aeris-widget-unit aeris-widget-unit-temp">F</span></div></div><div class="aeris-widget-currents-detblock"><div class="aeris-widget-currents-wx">{{observations.0.ob.weatherShort}}</div><ul><li><p class="aeris-widget-currents-detail-label">Feels Like</p><p class="aeris-widget-currents-detail-value">{{observations.0.ob.feelslikeF}}&deg;</p></li><li><p class="aeris-widget-currents-detail-label">Winds</p><p class="aeris-widget-currents-detail-value">{{observations.0.ob.windDir}} {{observations.0.ob.windMPH}} mph</p></li><li><p class="aeris-widget-currents-detail-label">Dew Point</p><p class="aeris-widget-currents-detail-value">{{observations.0.ob.dewpointF}}&deg;</p></li><li><p class="aeris-widget-currents-detail-label">Humidity</p><p class="aeris-widget-currents-detail-value">{{observations.0.ob.humidity}}%</p></li><li><p class="aeris-widget-currents-detail-label">Pressure</p><p class="aeris-widget-currents-detail-value">{{observations.0.ob.pressureIN}} in</p></li></ul></div></div></div></div>'},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES,params:{p:this.params.p}},{endpoint:a.endpoints.OBS,params:{p:this.params.p}},{endpoint:a.endpoints.ADVISORIES,params:{p:this.params.p}}],{})},_afterRender:function(g){var h=this.$(".aeris-widget-bottom").width();var e=this.$(".aeris-widget-currents-wxblock");var f=this.$(".aeris-widget-currents-detblock");var d=h-e.outerWidth(true)-parseInt(e.css("left"),10)-parseInt(f.css("right"),10)-10;f.css({width:d})}});a.widgets.CurrentsCompact=a.Widget.extend({prefix:"currents-compact",defaults:{cls:"",tpl:'<div class="aeris-widget-outer aeris-widget-currents-compact"><div class="aeris-widget-inner"><div class="aeris-widget-currents-compact-icon"><img src="{{paths.wxicons}}{{observations.0.ob.icon}}" /></div><div class="aeris-widget-currents-compact-temp">{{observations.0.ob.tempF}}&deg;</div>{{#advisories}}<div class="aeris-widget-currents-compact-alert"></div>{{/advisories}}</div></div>'},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES},{endpoint:a.endpoints.OBS},{endpoint:a.endpoints.ADVISORIES}],{p:this.params.p})}});a.widgets.ShortTermOutlookCompact=a.Widget.extend({prefix:"24hr-compact",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-24hr-compact"><div class="aeris-widget-inner"><div class="aeris-widget-24hr-compact-now"><div class="aeris-widget-24hr-compact-pad"><div class="aeris-widget-24hr-compact-title">Currently</div><div class="aeris-widget-24hr-compact-icon"><img src="{{paths.wxicons}}{{observations.0.ob.icon}}" /></div><div class="aeris-widget-24hr-compact-temp">{{observations.0.ob.tempF}}&deg;</div>{{#advisories}}<div class="aeris-widget-currents-compact-alert"></div>{{/advisories}}</div></div><div class="aeris-widget-24hr-compact-periods">{{#forecasts.0.periods}}<div class="aeris-widget-24hr-compact-period"><div class="aeris-widget-24hr-compact-title">{{timeofday validTime}}</div><div class="aeris-widget-24hr-compact-pad"><div class="aeris-widget-24hr-compact-icon"><img src="{{../paths.wxicons}}{{icon}}" /></div><div class="aeris-widget-24hr-compact-temp">{{minmax this}}&deg;</div></div></div>{{/forecasts.0.periods}}</div></div></div>',helpers:{minmax:function(d){if(d.isDay==true){return d.maxTempF}return d.minTempF}}},params:{filter:"daynight",limit:2}},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.OBS,params:{p:this.params.p}},{endpoint:a.endpoints.ADVISORIES,params:{p:this.params.p}},{endpoint:a.endpoints.FORECASTS,params:{p:this.params.p,limit:2,filter:"daynight"}}],{})},_afterRender:function(d){this.$(".aeris-widget-24hr-compact-period:last").addClass("aeris-widget-24hr-compact-period-last")}});a.widgets.Forecast=a.Widget.extend({prefix:"fcst",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-fcst"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{places.0.place.name}}, {{places.0.place.state}}</div><div class="aeris-widget-loader-update"></div><div class="aeris-widget-tbar"><div class="aeris-widget-tbar-ctrls"><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-search"></a><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-geolocate"></a></div></div></div>{{> search}}{{> error}}<div class="aeris-widget-bottom"><div class="aeris-widget-fcst-periods"><ul>{{#forecasts.0.periods}}<li><p class="aeris-widget-fcst-period-name">{{dayformat validTime}}</p><p class="aeris-widget-fcst-period-icon"><img src="{{../paths.wxicons}}{{icon}}" /></p><p class="aeris-widget-fcst-period-hi">{{maxTempF}}&deg;</p><p class="aeris-widget-fcst-period-lo">{{minTempF}}&deg;</p></li>{{/forecasts.0.periods}}</ul></div></div></div></div>',helpers:{dayformat:function(e){var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var g;if(typeof(e)==="string"){var f=e.split(/-|\+|\s+|:|T/);g=new Date(f[0],f[1]-1,f[2],f[3],f[4],f[5],0)}else{g=new Date(e*1000)}return h[g.getDay()].substr(0,3)}}},opts:{resize:{col:{autocalc:true}}}},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES,params:{p:this.params.p}},{endpoint:a.endpoints.FORECASTS,params:{p:this.params.p,limit:(this.params.limit!==undefined)?this.params.limit:7}}],{})},_afterRender:function(){if(this.opts.resize.col.autocalc===false){return}var f=this.$(".aeris-widget-fcst-periods > ul > li");var g=this.$(".aeris-widget-inner").width();var d=Math.floor(g/f.length);var e=cw=0;if(d>0){a._.each(f,function(h){var i=c(h);cw=d-(i.outerWidth()-i.width());i.css({width:cw});e+=i.outerWidth()})}if(g>0&&e<g){this.$(".aeris-widget-fcst-periods > ul > li:last").css({width:cw+(g-e)})}}});a.widgets.NearbyWeather=a.Widget.extend({prefix:"nearbywx",defaults:{cls:"",tpl:'<div class="aeris-widget-outer aeris-widget-nearbywx"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">Nearby Weather</div><div class="aeris-widget-loader-update"></div>{{> toolbar}}</div>{{> search}}{{> error}}<div class="aeris-widget-bottom"><ul class="aeris-widget-nearbywx-listing">{{#locations}}<li><div class="aeris-widget-nearbywx-name"><a href="{{../links.wxlocal}}?pands={{lower places.place.name}},{{#if places.place.state}}{{lower places.place.state}}{{else}}{{lower places.place.country}}{{/if}}">{{places.place.name}}{{#if places.place.state}}, {{places.place.state}}{{/if}}</a></div><div class="aeris-widget-nearbywx-temp">{{observations.0.ob.tempF}}&deg;<span class="aeris-widget-unit aeris-widget-unit-temp">F</span></div><div class="aeris-widget-nearbywx-icon"><img src="{{../paths.wxicons}}{{observations.0.ob.icon}}" /></div><div class="aeris-widget-nearbywx-detail">Feels Like {{observations.0.ob.feelslikeF}}&deg;</div>{{#if advisories}}<a class="aeris-widget-nearbywx-alerts" href="{{../../links.wxlocal}}local/{{lower places.place.country}}/{{lower places.place.state}}/{{lower places.place.name}}/warnings.html"><div class="aeris-widget-nearbywx-count">{{advisories.length}}</div><div class="aeris-widget-nearbywx-label">active alerts</div></a>{{/if}}</li>{{/locations}}</ul></div></div></div>'},places:[],load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Places();d.bind("load",function(g){e.hideLoader();var f=[];e.places.length=0;a._.each(g.models,function(h){e.places.push(h.get("place.name")+","+h.get("place.state")+","+h.get("place.country"));f.push({places:h.toJSON(),observations:[{ob:{icon:"na.png"}}]})});e.render({locations:f});e._loadWxData(g)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch(a.actions.CLOSEST,this.params)},_loadWxData:function(j){var k=this;var h={};locData=[];var l=0;for(var g=0,d=this.places.length;g<d;g++){var e=this.places[g];var f=new a.collections.Batch();h[f.cid]=g;f.bind("load",function(n){var m=h[n.cid];var i=a._.extend({},{places:j.at(m).toJSON()},n.toJSON().data);locData[m]=i;l++;if(l===d){k.hideLoader();k.render({locations:locData})}});f.bind("loaderror",function(n,m,i){k.hideLoader();k.showError(i,2000)});f.fetch([{endpoint:a.endpoints.OBS,action:a.actions.ID,params:{p:this.places[g]}},{endpoint:a.endpoints.ADVISORIES,action:a.actions.ID,params:{p:this.places[g]}}],{})}}});a.widgets.Advisories=a.Widget.extend({prefix:"advisories",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-advisories"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{places.0.place.name}}, {{places.0.place.state}}</div><div class="aeris-widget-loader-update"></div>{{> toolbar}}</div>{{> search}}{{> error}}<div class="aeris-widget-bottom"><ul class="aeris-widget-advisories-listing">{{#if advisories}}{{#advisories}}<li><p class="aeris-widget-advisories-name">{{ucwords details.name}}</p><p class="aeris-widget-advisories-expires">expires {{dateformat timestamps.expiresISO}}</p><div class="aeris-widget-advisories-icon aeris-widget-advisories-icon-{{alerttype details.type}}"></div></li>{{/advisories}}{{else}}<li class="aeris-widget-error">There are currently no active advisories.</li>{{/if}}</ul></div></div></div>',helpers:{alerttype:function(e){var d="adv";if(e.match(/\.W$/)){d="warn"}else{if(e.match(/\.A$/)){d="watch"}}return d},dateformat:function(i){var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var f=["January","February","March","April","May","June","July","August","September","October","November","Decemeber"];var k;if(typeof(i)==="string"){var j=i.split(/-|\+|\s+|:|T/);k=new Date(j[0],j[1]-1,j[2],j[3],j[4],j[5],0)}else{k=new Date(i*1000)}if(!k){return}var h=k.getHours();var g=String("00000"+k.getMinutes()).slice(-2);var e=(h>=12)?"pm":"am";if(h>12){h-=12}if(h===0){h=12}return(l[k.getDay()].substr(0,3)+", "+f[k.getMonth()].substr(0,3)+" "+k.getDate()+" at "+h+":"+g+e)}}}},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES,params:{p:this.params.p}},{endpoint:a.endpoints.ADVISORIES,params:this.params}],{})}});a.widgets.StormReports=a.Widget.extend({prefix:"stmreports",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-stmreports"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{places.0.place.name}}, {{places.0.place.state}}</div><div class="aeris-widget-loader-update"></div><div class="aeris-widget-tbar"><div class="aeris-widget-tbar-ctrls"><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-search"></a><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-geolocate"></a></div></div></div>{{> search}}{{> error}}{{> filters}}<div class="aeris-widget-stmreports-listing">{{#if stormreports}}<ul>{{#stormreports}}{{> row}}{{/stormreports}}</ul>{{else}}<div class="aeris-widget-error">No storm reports for the selected type found.</div>{{/if}}</div></div></div>',partials:{row:'<li><div class="aeris-widget-stmreports-icon aeris-widget-stmreports-icon-code-{{report.code}}"></div><div class="aeris-widget-stmreports-profile"><div class="aeris-widget-stmreports-name">{{ucwords report.type}}<span class="aeris-widget-stmreports-total">{{total report.detail}}</span></div><div class="aeris-widget-stmreports-details">{{ucwords place.name}}, {{upper place.state}} - {{dateformat report.datetime}}</div></div></li>',filters:'<div class="aeris-widget-stmreports-ctrl"><ul><li class="filter-all"><a>All</a></li><li class="filter-tornado"><a>Tornado</a></li><li class="filter-rain"><a>Rain</a></li><li class="filter-wind"><a>Wind</a></li><li class="filter-snow"><a>Snow</a></li><li class="filter-hail"><a>Hail</a></li><li class="filter-ice"><a>Ice</a></li></ul></div>'},helpers:{total:function(e){var d="";if(e.snowIN){d=e.snowIN+'"'}else{if(e.rainIN){d=e.rainIN+'"'}else{if(e.windSpeedMPH){d=e.windSpeedMPH+" mph"}}}return((d!="")?" - "+d:"")},dateformat:function(o){var k;if(typeof(o)==="string"){var e=o.split(/-|\+|\s+|:|T/);k=new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5],0)}else{k=new Date(o*1000)}var n=k.getFullYear();var g=k.getMonth();var f=k.getDate();var j=k.getHours();var i=k.getMinutes();var l=(j>=12)?"pm":"am";j=(j>12)?j-12:((j==0)?12:j);i=(i<10)?"0"+i:i;return((g+1)+"/"+f+"/"+n+" at "+j+":"+i+l)}}},updates:{target:".aeris-widget-stmreports-listing"},params:{limit:50}},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES,params:{p:this.params.p}},{endpoint:a.endpoints.STMREPORTS,action:a.actions.CLOSEST,params:this.params}],{})},filter:function(d){this.$(".aeris-widget-stmreports-ctrl li").removeClass("sel");this.$(".aeris-widget-stmreports-ctrl li.filter-"+d).addClass("sel");this.params.filter=(d!="all")?d:null;this.load()},_afterRender:function(f){var e=this;var d=this.params.filter||"all";this.$(".aeris-widget-stmreports-ctrl li.filter-"+d).addClass("sel");this.$(".aeris-widget-stmreports-ctrl li").click(function(i){var h=i.currentTarget;var g=c(h).attr("class").replace(/^filter-(\w+)( sel)?$/,"$1");e.filter(g)})},_afterUpdate:function(f){var e=this.view.snippet(".aeris-widget-title");var d=Handlebars.compile(e);var h=d(f);var g=this.$(".aeris-widget-title");if(g.html()!=h){g.fadeOut(100,function(){g.html(d(f));g.fadeIn(100)})}}});a.widgets.TempExtremes=a.Widget.extend({prefix:"currents-compact",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-tempextremes"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{ucwords countries.0.place.name}}</div><div class="aeris-widget-loader-update"></div>{{> toolbar}}</div>{{> search}}{{> error}}<div class="aeris-widget-bottom"><ul><li class="aeris-widget-tempextremes-max"><div class="aeris-widget-tempextremes-label">Highest Temp</div><div class="aeris-widget-tempextremes-icon"></div><div class="aeris-widget-tempextremes-profile">{{#if observations.0.ob}}<div class="aeris-widget-tempextremes-val">{{observations.0.ob.tempF}}&deg;<span class="aeris-widget-unit aeris-widget-unit-temp">F</span></div><div class="aeris-widget-tempextremes-name">{{ucwords observations.0.place.name}}}{{#if observations.0.place.state}}, {{upper observations.0.place.state}}{{/if}}</div>{{else}}<div class="aeris-widget-tempextremes-error">No observation found.</div>{{/if}}</div></li><li class="aeris-widget-tempextremes-min"><div class="aeris-widget-tempextremes-label">Lowest Temp</div><div class="aeris-widget-tempextremes-icon"></div><div class="aeris-widget-tempextremes-profile">{{#if observations.1.ob}}<div class="aeris-widget-tempextremes-val">{{observations.1.ob.tempF}}&deg;<span class="aeris-widget-unit aeris-widget-unit-temp">F</span></div><div class="aeris-widget-tempextremes-name">{{ucwords observations.1.place.name}}{{#if observations.1.place.state}}, {{upper observations.1.place.state}}{{/if}}</div>{{else}}<div class="aeris-widget-tempextremes-error">No observation found.</div>{{/if}}</div></li></ul></div></div></div>',partials:{search:'<div class="aeris-widget-search"><label>Country</label><input type="text" name="aeris-tempextremes-search" /></div>'}},opts:{country:"us",toolbar:{geolocate:false}}},load:function(){this.showLoader();var f=this;var e="country:"+this.opts.country;if(this.params.query){e+=this.params.query}var d=new a.collections.Batch();d.bind("load",function(g){f.hideLoader();f.render(g.toJSON().data)});d.bind("loaderror",function(i,h,g){f.hideLoader();f.showError(g,2000)});d.bind("collectionerror",function(g){});d.fetch([{endpoint:a.endpoints.OBS,action:a.actions.SEARCH,params:{sort:"temp:-1",limit:1,query:e+",temp:-999"}},{endpoint:a.endpoints.OBS,action:a.actions.SEARCH,params:{sort:"temp",limit:1,query:e+",temp:-999"}},{endpoint:a.endpoints.COUNTRIES,params:{p:this.opts.country}}],{})},_afterRender:function(g){var f=this;var d=this.$(".aeris-widget-bottom > ul > li").width();var e=this.$(".aeris-widget-bottom > ul > li .aeris-widget-tempextremes-icon").outerWidth(true);this.$(".aeris-widget-bottom > ul > li .aeris-widget-tempextremes-profile").width(d-e);if(this.$(".aeris-widget-search").is("*")){var h=new a.collections.Countries();this.$(".aeris-widget-search input").autocomplete({source:function(j,i){h.fetch(a.actions.SEARCH,{query:"name:^"+j.term+";iso:"+j.term+";iso3:"+j.term,limit:10});h.bind("load",function(k){i(c.map(k.toJSON().models,function(l){return{label:l.place.name,value:l.place.iso}}))})},minLength:2,appendTo:this.content,select:function(j,i){if(i.item){f.$(".aeris-widget-search input").val(i.item.label);f.opts.country=i.item.value;f.reload()}}})}}});a.widgets.Records=a.Widget.extend({prefix:"records",defaults:{cls:"",tpl:{container:'<div class="aeris-widget-outer aeris-widget-records"><div class="aeris-widget-inner"><div class="aeris-widget-top"><div class="aeris-widget-title">{{places.0.place.name}}, {{places.0.place.state}}</div><div class="aeris-widget-loader-update"></div><div class="aeris-widget-tbar"><div class="aeris-widget-tbar-ctrls"><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-search"></a><a class="aeris-widget-tbar-btn aeris-widget-tbar-btn-geolocate"></a></div></div></div>{{> search}}{{> error}}{{> filters}}<div class="aeris-widget-records-listing">{{#if records}}<ul>{{#records}}{{> row}}{{/records}}</ul>{{else}}<div class="aeris-widget-error">No records for the selected type found.</div>{{/if}}</div></div></div>',partials:{row:'<li><div class="aeris-widget-records-icon aeris-widget-records-icon-type-{{report.type}}"></div><div class="aeris-widget-records-profile"><div class="aeris-widget-records-name">{{typename report.type}}<span class="aeris-widget-records-total">{{total report.detail}}</span></div><div class="aeris-widget-records-details">{{ucwords place.name}}, {{upper place.state}} - {{dateformat report.timestamp}}</div></div></li>',filters:'<div class="aeris-widget-records-ctrl"><ul><li class="filter-all"><a>All</a></li><li class="filter-prcp"><a>Precip</a></li><li class="filter-snow"><a>Snow</a></li><li class="filter-maxt"><a>High</a></li><li class="filter-mint"><a>Low</a></li><li class="filter-lomx"><a>Cool High</a></li><li class="filter-himn"><a>Warm Low</a></li></ul></div>'},helpers:{typename:function(d){var e="";if(d=="maxt"){e="High Temp"}else{if(d=="mint"){e="Low Temp"}else{if(d=="prcp"){e="Precip"}else{if(d=="snow"){e="Snow"}else{if(d=="lomx"){e="Cool High Temp"}else{if(d=="himn"){e="Warm Low Temp"}else{e=d}}}}}}return e},total:function(e){var d="";e=e||{};if(undefined!==e.snowIN){d=e.snowIN+'"'}else{if(undefined!==e.rainIN){d=e.rainIN+'"'}else{if(undefined!==e.tempF){d=e.tempF+"&deg;F"}}}return((d!=="")?" - "+d:"")},dateformat:function(f){var i;if(typeof(f)==="string"){var h=f.split(/-|\+|\s+|:|T/);i=new Date(h[0],h[1]-1,h[2],h[3],h[4],h[5],0)}else{i=new Date(f*1000)}var j=i.getFullYear();var e=i.getMonth();var g=i.getDate();return((e+1)+"/"+g+"/"+j)}}},updates:{target:".aeris-widget-records-listing"},params:{limit:50}},load:function(){if(this._geo()){return}this.showLoader();var e=this;var d=new a.collections.Batch();d.bind("load",function(f){e.hideLoader();e.render(f.toJSON().data)});d.bind("loaderror",function(h,g,f){e.hideLoader();e.showError(f,2000)});d.fetch([{endpoint:a.endpoints.PLACES,params:{p:this.params.p}},{endpoint:a.endpoints.RECORDS,action:a.actions.CLOSEST,params:this.params}],{})},filter:function(d){this.$(".aeris-widget-records-ctrl li").removeClass("sel");this.$(".aeris-widget-records-ctrl li.filter-"+d).addClass("sel");this.params.filter=(d!="all")?d:null;this.load()},_afterRender:function(f){var e=this;var d=this.params.filter||"all";this.$(".aeris-widget-records-ctrl li.filter-"+d).addClass("sel");this.$(".aeris-widget-records-ctrl li").click(function(i){var h=i.currentTarget;var g=c(h).attr("class").replace(/^filter-(\w+)( sel)?$/,"$1");e.filter(g)})},_afterUpdate:function(f){var e=this.view.snippet(".aeris-widget-title");var d=Handlebars.compile(e);var h=d(f);var g=this.$(".aeris-widget-title");if(g.html()!=h){g.fadeOut(100,function(){g.html(d(f));g.fadeIn(100)})}}})}).call(this);